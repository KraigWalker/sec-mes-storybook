(this["webpackJsonpsecure-messages-webapp"]=this["webpackJsonpsecure-messages-webapp"]||[]).push([[0],{102:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(79),a=n(103),c=Object(r.a)({reducerPath:"messages",baseQuery:a.a,tagTypes:["Message"],endpoints:function(e){return{getMessages:e.query({query:function(){return"securemessages"},transformResponse:function(e){return e.secure_messages||[]}})}}}),u=c.useGetMessagesQuery},103:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(17),a=n.n(r),c=n(30),u=n(39),s=n(25),o=Object(s.d)({baseUrl:"",prepareHeaders:function(e,t){var n=(0,t.getState)().auth.token;return n&&e.set("authentication","Bearer ".concat(n)),e.set("apiVersion","1.2.0"),e}});function i(e,t,n){return b.apply(this,arguments)}function b(){return(b=Object(u.a)(a.a.mark((function e(t,n,r){var u,s,i,b,d,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=n.getState(),s=u.config.baseApiUrl,i=u.session.bankId,s){e.next=5;break}return e.abrupt("return",{error:{status:400,data:"No `baseApiUrl` received from config."}});case 5:if(i){e.next=7;break}return e.abrupt("return",{error:{status:400,data:"No `bankId` received from session parameters."}});case 7:return b="string"===typeof t?t:t.url,d="".concat(s,"/banks/").concat(i,"/").concat(b),l="string"===typeof t?d:Object(c.a)(Object(c.a)({},t),{},{url:d}),e.abrupt("return",o(l,n,r));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},104:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(79),a=n(103),c=Object(r.a)({reducerPath:"accounts",baseQuery:a.a,tagTypes:["Account"],endpoints:function(e){return{getAccounts:e.query({query:function(){return"accounts/default"},transformResponse:function(e){return e.accounts||[]}})}}}),u=c.useGetAccountsQuery},424:function(e,t,n){},425:function(e,t,n){"use strict";n.r(t);n(203),n(213);var r=n(0),a=n.n(r),c=n(101),u=n.n(c),s=n(106),o=n(19),i=n(16),b=n(100),d=n(18),l="/secure-messages",p="/documents";function f(){return null}var h=Object(b.a)((function(){return n.e(14).then(n.bind(null,665)).then((function(e){return e.SecureMessagesRoutes}))})),g=Object(b.a)((function(){return n.e(13).then(n.bind(null,666)).then((function(e){return e.LettersAndDocumentsRoutes}))})),j=Object(b.a)((function(){return n.e(12).then(n.bind(null,667)).then((function(e){return e.DigitalStatementsRoutes}))}));function k(){return Object(d.jsx)(r.Suspense,{fallback:f,children:Object(d.jsxs)(i.d,{children:[Object(d.jsx)(i.a,{from:"/securemessages",to:l}),Object(d.jsx)(i.a,{from:"/my-documents",to:p}),Object(d.jsx)(i.b,{path:l,component:h}),Object(d.jsx)(i.b,{path:p,component:g}),Object(d.jsx)(i.b,{path:"/digital-statements",component:j}),Object(d.jsx)(i.a,{exact:!0,from:"/",to:l})]})})}var m=n(35),x=n(17),O=n.n(x),v=n(39),y=n(2),w=n(44),_=n(30),S=n(136),A={};var T=Object(y.createSlice)({name:"session",initialState:{},reducers:{getSessionDetails:function(e,t){var n=Object(S.parse)(window.location.search),r=Object(S.parse)(window.location.hash);return Object(_.a)(Object(_.a)(Object(_.a)(Object(_.a)(Object(_.a)(Object(_.a)(Object(_.a)({},(n.user_tracking_id||r.user_tracking_id)&&{userTrackingId:n.user_tracking_id||r.user_tracking_id||null}),(n.bank_id||n.bankId||r.bank_id||r.bankId||A.bankId)&&{bankId:n.bank_id||n.bankId||r.bank_id||r.bankId||A.bankId||null}),(n.brandId||n.brand_id||r.brandId||r.brand_id)&&{brandId:n.brandId||n.brand_id||r.brandId||r.brand_id}),(n.state||r.state)&&{state:n.state||r.state}),(n.client_context||r.client_context)&&{clientContext:n.client_context||r.client_context}),(n.isDocumentLibraryEnabled||r.isDocumentLibraryEnabled)&&{isDocumentLibraryEnabled:n.isDocumentLibraryEnabled||r.isDocumentLibraryEnabled}),(n.exchangeToken||r.exchangeToken)&&{exchangeToken:n.exchangeToken||r.exchangeToken})},clearQueryString:function(e){return e},clearHash:function(e){return e}},extraReducers:{}}),I=T.actions,E=T.reducer,P=I.getSessionDetails,R=Object(y.createAsyncThunk)("fetchConfig",Object(v.a)(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(window.location.origin),e.next=3,fetch("".concat(window.location.origin,"/config.json"));case 3:return t=e.sent,e.abrupt("return",t.json());case 5:case"end":return e.stop()}}),e)})))),U=Object(y.createAsyncThunk)("startup",function(){var e=Object(v.a)(O.a.mark((function e(t,n){var r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.dispatch,e.t0=Promise,e.next=4,r(R());case 4:return e.t1=e.sent,e.next=7,r(P());case 7:return e.t2=e.sent,e.t3=[e.t1,e.t2],e.abrupt("return",e.t0.all.call(e.t0,e.t3).then(Object(v.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([]).then((function(){Promise.resolve()})));case 1:case"end":return e.stop()}}),e)})))));case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),D=Object(y.createSlice)({name:"config",initialState:{baseApiUrl:null},extraReducers:Object(m.a)({},R.fulfilled,(function(e,t){e.baseApiUrl=t.payload.paasBaseApiUrl}))}),L=D.actions,q=D.reducer;L.getConfig,L.updateConfig,L.clearConfig;Object(w.a)((function(e){return e.baseApiUrl}));function B(e){var t=e.isSMEUser,n=void 0!==t&&t,a=Object(o.d)();return Object(r.useEffect)((function(){a(U())}),[a]),Object(d.jsx)(k,{hideLettersAndDocuments:n})}var C=Object(y.createAsyncThunk)("auth/getAuthTokenFromLocationHash",(function(e,t){return(0,t.rejectWithValue)("bar")})),W=n(137);function M(e,t){return t||"".concat(e.toUpperCase()," Web")}var N="WEB";function Q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return JSON.stringify({client:{user_tracking_id:t,app_title:M(e),app_package_name:N,app_version_code:navigator.appVersion,app_version_name:navigator.appName},env:{platform:N,platform_version:navigator.appVersion||navigator.vendor||window.opera,make:navigator.platform||window.opera,locale:navigator.language}})}var V,H,J=Object(W.fetchBaseQuery)({baseUrl:"/"}),K=function(){var e=Object(v.a)(O.a.mark((function e(t,n,r){var a,c,u,s,o;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.getState(),c=a.config.baseApiUrl){e.next=3;break}return e.abrupt("return",{error:{status:400,data:"No base API URL recieved"}});case 3:return u="string"===typeof t?t:t.url,s="".concat(c,"/banks/").concat(u),o="string"===typeof t?s:Object(_.a)(Object(_.a)({},t),{},{url:s}),e.abrupt("return",J(o,n,r));case 7:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),X="auth/provider/oauth2/",F="USER",G=Object(W.createApi)({reducerPath:"oAuth",baseQuery:K,endpoints:function(e){return{getExchangeToken:e.query({query:function(e){var t=e.shortExchangeToken,n=void 0===t?"fakeShortToken":t,r=e.bankId;return{url:"".concat(r,"/").concat(X,"token/exchange/jwt"),method:"POST",headers:{"content-type":"application/x-www-form-urlencoded",Authorization:"Bearer ".concat(n),"x-bpi-client-context":Q(r),"x-bpi-service-context":F,"X-TS-AJAX-Request":!0},body:"grant_type=client_credentials&scope=30"}}}),getPublicKey:e.query({query:function(e){var t=e.bankId;return{url:"".concat(X,"jwt/publickey"),headers:{"x-bpi-client-context":Q(t),"x-bpi-service-context":F,"X-TS-AJAX-Request":!0}}}})}}}),Y=G.endpoints,z=Y.getExchangeToken,Z=Y.getPublicKey,$=Object(y.createAsyncThunk)("auth/getAuthTokenFromCookie",function(){var e=Object(v.a)(O.a.mark((function e(t,r){var a,c,u,s,o,i,b,d,l,p,f,h,g,j,k,m,x,v,y,w,_;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r.dispatch,c=r.getState,u=r.rejectWithValue,s=r.fulfillWithValue,o=c(),i=o.session,b=i.exchangeToken,!(d=i.bankId)){e.next=8;break}return e.next=5,a(Z.initiate({bankId:d}));case 5:f=e.sent,h=f.data.public_key,l=h;case 8:if(!b||!d){e.next=17;break}return e.next=11,a(z.initiate({exchangeToken:b,bankId:d}));case 11:if((g=e.sent).error){e.next=14;break}return e.abrupt("return",g.data);case 14:return e.abrupt("return",g);case 17:return e.next=19,n.e(15).then(n.t.bind(null,668,7));case 19:if(j=e.sent,k=j.get,m=k("ibjwt")){e.next=26;break}return e.abrupt("return",u("could not retrieve a value from Cookie"));case 26:p=m.trim();case 27:return e.next=30,Promise.all([n.e(3),n.e(5)]).then(n.t.bind(null,669,7));case 30:return x=e.sent,e.prev=31,v=x.verify(p,"-----BEGIN PUBLIC KEY-----".concat(l,"-----END PUBLIC KEY-----"),{algorithms:["RS256","HS256","HS384","HS512","RS384","RS512","none"]}),e.abrupt("return",s(v));case 36:return e.prev=36,e.t0=e.catch(31),y=e.t0.name,w=e.t0.message,_=e.t0.stack,e.abrupt("return",u({name:y,message:w,stack:_}));case 42:e.next=45;break;case 44:return e.abrupt("return",s("thisIsAFakeJWTBecauseWeAreInDevelopmentMode"));case 45:case"end":return e.stop()}}),e,null,[[31,36]])})));return function(t,n){return e.apply(this,arguments)}}()),ee=Object(y.createAsyncThunk)("auth/getAuthToken",function(){var e=Object(v.a)(O.a.mark((function e(t,n){var r,a,c,u,s,o,i;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.dispatch,a=n.rejectWithValue,e.next=3,r($());case 3:if(c=e.sent,u=c.payload,!c.error){e.next=13;break}return e.next=9,r(C());case 9:return s=e.sent,o=s.payload,i=s.error,e.abrupt("return",i?a():o);case 13:return e.abrupt("return",u);case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),te=Object(y.createSlice)({name:"auth",initialState:{accessToken:null,publicToken:null},reducers:{},extraReducers:(V={},Object(m.a)(V,C.fulfilled,(function(e,t){e.accessToken=t.payload})),Object(m.a)(V,ee.rejected,(function(e,t){})),Object(m.a)(V,ee.fulfilled,(function(e,t){e.accessToken=t.payload})),V)}).reducer,ne=n(102),re=n(104),ae=Object(y.configureStore)({reducer:(H={auth:te,config:q},Object(m.a)(H,re.a.reducerPath,re.a.reducer),Object(m.a)(H,ne.a.reducerPath,ne.a.reducer),Object(m.a)(H,G.reducerPath,G.reducer),Object(m.a)(H,"session",E),H),middleware:function(e){return e().concat(re.a.middleware,ne.a.middleware,G.middleware)}});n(424);Promise.resolve().then((function(){})).then((function(){u.a.render(Object(d.jsx)(a.a.StrictMode,{children:Object(d.jsx)(s.a,{children:Object(d.jsx)(o.a,{store:ae,children:Object(d.jsx)(B,{})})})}),document.getElementById("root"))}))}},[[425,1,2]]]);
//# sourceMappingURL=main.e8b04c0d.chunk.js.map